Версия 0.1 от 29.06.24
Базовый функционал- минимум для запуска, корректной работы и остановки sing-box.

Версия 0.2 от 01.07.24
1. Добавлена команда для рестарта скрипта:
sbs restart
2. Добавлено автоматическое создание системных скриптов firewall-start и services-start а так же проверки на их существование, автоматическое добавление и удаление в них записей и правил а так же проверки на их существование, для предотвращения их дублирования. Это необходимо для предотвращения внезапного некорректного завершения работы скрипта при некоторых событиях в системе, а так же для корректного автостарта скрипта при перезагрузке роутера.
3. Добавлена проверка на существование процесса sing-box для предотвращения дублирования некоторых функций. Теперь при попытке дважды подряд запустить скрипт, он этого не позволит.
4. Устранены найденные ошибки.

Версия 0.3 от 03.07.24
1. Добавлена команда для настройки скрипта
sbs setup
Настройка производится в консоли роутера- некоторые настройки выполняются полуавтоматически- необходимо подтверждение, рекомендуется подтвердить, а парочку вбиваем в консоль в ответ на запросы с подсказками.
2. Частично выполнена подготовка к переходу на полностью автоматическую установку.

Версия 0.4 от 04.07.24
Автоустановка скритпа и всего необходимого одной командой в консоли роутера:
wget -O /jffs/scripts/sbs-ru https://raw.githubusercontent.com/Dr4tez/sing-box4asus/main/sbs-ru && chmod 775 /jffs/scripts/sbs-ru && /jffs/scripts/sbs-ru install

Версия 0.5 от 11.07.24
1. Список ip адресов устройств, номер таблицы маршрутизации и имя TUN интерфейса вынесены в отдельный файл конфигурации- script-conf.
2. Изменения в коде всвязи с переездом скрипта в директорию /jffs/addons/sing-box.
3. Теперь скрипт можно запускать командой
sbs
-при выполнении без дополнительных параметров или с ошибочными параметрами, будет выведен список поддерживаемых параметров с их кратким описанием и возможностью запуска по номеру.
4. Добавлены новые команды:
sbs edit
-для редактирования редактором nano файла config.json,
sbs remove
-после однократного запроса подтверждения, останавливает все процессы скрипта, откатывает изменения, внесённые в системные скрипты, и выполняет полное удаление всех файлов и директорий скрипта.
5. Теперь после старта скрипта в консоли, роутер можно не перезагружать, скрипт продолжит корректно работать после закрытия консоли.
6. Многочисленные оптимизации.
7. Скрипт стал более юзер-френдли.

Версия 0.6 от 17.07.24
1. Добавлено автоматическое восстановление правил ip для таблицы маршрутизации скрипта после системных событий, вызывающих их удаление. Например, такое событие вызывается нажатием кнопки "Применить" в разделе "Интернет" вэб интерфейса роутера.
2. Изменены имена файлов скрипта и директории.
3. Инсталлер и основной скрипт объединены в один скрипт.
4. Редактирование config.json в редакторе nano теперь перенесено в команду
sbs setup
5. Команда
sbs edit
теперь выполняет редактирование файла настроек sbs-conf в редакторе nano.
6. Добавлена команда
sbs update
для обновления файла основного скрипта, скрипта монитора и ядра sing-box.
7. Исправления найденных ошибок и багов прошлой версии.

Версия 0.7 от 25.07.24
1. Поддержка одновременной работы до двух TUN интерфейсов. Будет полезно, если, например, вы одновременно хотите направить трафик одних устройств через sing-box по правилам, прописанным в конфигурационном файле sing-box, а трафик других устройств полностью направить в proxy туннель.
2. Добавлена команда
sbs check
Эта функция встроена в ядро sing-box и используется для проверки корректности составления конфигурационного файла sing-box (config.json).  Определяет не все ошибки, но, в большинстве случаев, отлично помогает в их поиске. В результате выполнения, показывает первую найденую ошибку с указанием её номера строки и столбца в config.json. Далее, для исправления ошибки, предлагается открыть config.json в редакторе nano. После иправления и завершения редактирования, находится следующая ошибка, если она есть, и также предлагается её исправить в редакторе nano. Так будет повторяться, пока вы не исправите все ошибки, или не решите завершить это, отказавшись от редактирования очередной ошибки.
3. Добавлена команда
sbs format
Эта функция встроена в ядро sing-box и используется для придания config.json легко читаемой, задуманной разработчиком sing-box, структуры. Сначала команда sbs format, как и sbs check, проверяет config.json на ошибки. Если ошибки будут найдены, то format будет невозможен, пока вы их все не устраните. После устранения всех ошибок, структура конфигурационного файла будет оптимизирована, результат будет выведен в консоль и будет предложено сохранить его в ваш config.json.
4. Мелкие багфиксы.

Версия 0.8 от 04.08.24
Добавлена команда
sbs status
которая показывает запущен ли sing-box, а так же версии установленных скрипта SBS и ядра sing-box.

Версия 0.9 от 09.08.24
1. Исправления обнаруженных ошибок.
2. Добавлена поддержка роутеров с архитектурой процессоров ARMv7/AArch32. До этого поддерживались только с архитектурой ARMv8/AArch64.

Версия 1.0 от 13.08.24
1. В вывод команды 'sbs status' добавлены архитектура ядра sing-box и архитектура CPU роутера.
2. Теперь для устройств, трафик которых направляется через sing-box, скрипт добавляет в систему правила маршрутизации, направляющие их локальный трафик в обход sing-box. Это позволяет этим устройствам лучше взаимодействовать друг с другом и с другими устройствами в локальной сети.
3. Улучшение логики работы скрипта sbs-monitor.

Версия 1.1 от 23.08.24
1. Оптимизированы создаваемые скриптом маршруты и правила маршрутизации.
2. При остановке скрипта применён более простой и надёжный метод удаления создаваемых при старте скрипта таблиц маршрутизации.
3. Теперь при выполнении команды 'sbs update' появляется меню с выбором компонентов для обновления и отображением их установленных и доступных версий.
4. Теперь, при настройке скрипта командой 'sbs setup', в поле для ввода ip адресов устройств можно ввести всю подсеть роутера. Единственный минус этого- пропадёт доступ к вэб интерфейсу роутера из WAN, если он у вас разрешён в настройках роутера. Так же пропадёт доступ из WAN через переадресацию портов к другим устройствам в сети роутера. Но так было и до этого для всех устройств, ip адреса которых были введены при настройке скрипта.

Версия 1.2 от 01.09.24
1. Для настройки скрипта создано отдельное меню, вызываемое командой 'sbs setup'. В нём разделены функции, ранее выполнявшиеся одной командой 'sbs setup': добавление ip адресов устройств и изменение номеров таблиц маршрутизации. Так же в это меню добавлено редактирование файла настроек скрипта в редакторе nano, ранее выполнявшееся отдельной командой 'sbs edit'.
2. В меню настройки скрипта, при добавлении подсети в формате CIDR в качестве ip адреса устройства, например 192.168.50.0/24, на следующем этапе предлагается ввести ip адреса исключений.
3. Для настройки конфигурационного файла sing-box создано отдельное меню, вызываемое командой 'sbs edit'. В нём объединены функции, ранее выполнявшиеся отдельными командами: проверка конфигурационного файла sing-box на наличие ошибок и оптимизация его структуры. Так же в это меню добавлено редактирование конфигурационного файла sing-box в редакторе nano, ранее предлагавшееся в процессе выполнения команды 'sbs setup'.
4. Доработаны основной скрипт и скрипт sbs-monitor для корректного добавления, удаления и восстановления правил и маршрутов с учётом подсетей и исключений.
5. Оптимизация кода и правка выводимых консолью сообщений.

Версия 1.3 от 19.09.24
1. Теперь настройки DNS в конфигурационном файле sing-box работают и для tun интерфейсов.
2. В меню настройки скрипта 'sbs setup' добавлен пункт выбора DNS серверов для tun интерфейсов - DNS серверы, настроенные в вэб-интерфейсе роутера, или DNS серверы, прописанные в конфигурационном файле sing-box.
3. Улучшена логика скрипта sbs-monitor.
4. Дополнен и переработан Readme-ru.txt. Обязательно ознакомьтесь с ним.

Версия 1.4 от 23.09.24
Оптимизации, багфиксы и улучшения логик для нескольких функций скрипта.

Версия 1.5 от 13.10.24
1. Добавлено новое меню, вызываемое командой 'sbs server', для указания портов, которые будут открыты из WAN в роутер при старте sing-box и закрыты при его остановке. Это пригодится для работы sing-box не только в режиме клиента, но и в режиме сервера с доступом из WAN, если он вам нужен. Для работы sing-box в режиме сервера с доступом из WAN пропишите в конфигурационном файле sing-box хотя бы один inbound прокси-сервер с шифрованием и авторизацией.
2. Код скрипта изменён для работы только с одним TUN интерфейсом, т.к. функционал, добавлявшийся вторым TUN интерфейсом, можно реализовать всего парой простых правил в конфигурационном файле sing-box. Это позволило решить проблемы при создании правил NAT для нескольких подсетей разного размера, а так же на треть уменьшило размер кода.
3. В связи с уменьшением разрешённого количества tun интерфейсов до одного, изменён шаблон файла конфигурации sing-box.
4. Для соблюдения приоритетов изменена логика добавления основным скриптом и монитором правил маршрутизации и nat. Теперь при настройке скрипта в меню 'sbs setup' можно добавлять любое количество подсетей любых размеров и в любом порядке. В итоге в создаваемых скриптом правилах маршрутизации и nat подсети меньшего размера всегда будут иметь приоритет над бОльшими.
5. В пункты настройки ip адресов меню 'sbs setup' добавлена новая опция- 'Добавить/удалить ip адреса'. Работает так: вводим ip адреса, разделяя их пробелами, те из них, которые уже есть в списке, удалятся из него, а те, которых нет- добавятся.
6. Из меню 'sbs setup' удалён пункт редактирования файла sbs-conf в редакторе nano.
7. Изменена команда вызова меню для редактирования и проверки файла config.json с 'sbs edit' на 'sbs config'.
8. Нумерация некоторых предоставляемых скриптом вариантов выбора изменена. Будьте внимательны при выборе опций, если привыкли к их изначальной нумерации.
9. В создаваемом скриптом файле sbs-conf текст комментариев заменён на русский, изменены переменные.
10. Несколько незначительных правок кода скрипта.

Версия 1.6 от 20.10.24
1. Исправлено завершение процесса sing-box при выходе из любого меню скрипта с помощью комбинации клавиш Ctrl+C, если вход в это меню осуществлялся в той же сессии терминала, что и последний запуск sing-box.
2. При остановке sing-box реализовано удаление из скриптов firewall-start, nat-start и services-start всех записей, создаваемых скриптом sing-box при его старте, по тексту комментария "sing-box-script", добавляемого к записям. Это гарантирует удаление всех созданных скриптом записей, без вреда для других.
3. Ещё несколько багфиксов.

Версия 1.7 от 25.11.24
1. Реализована поддержка fakeip для направления через sing-box только выбранных доменов.
2. Удалён выбор источника DNS серверов. Теперь sing-box может использовать только DNS серверы, прописанные в конфигурационном файле sing-box.
3. В вывод команды 'sbs status' добавлена версия ядра системы.
4. Багфиксы, улучшения и оптимизации.

Версия 1.8 от 09.04.25
1. В коде скрипта 'curl' заменён на 'wget' для исключения ошибок на некоторых роутерах.
2. Русская и английская версии скрипта объединены в одну. Нужный язык выбирается при установке скрипта, но потом его можно изменить через меню, вызываемое командой 'sbs lang', либо выбором пункта 9 в основном меню, вызываемом командой 'sbs'.
3. Оптимизация некоторых участков кода скрипта.
4. После обновления до версии 1.8 все последующие обновления будут выполняться только через меню, вызываемое командой 'sbs update'.

Версия 1.9 от 12.04.25
1. В вывод команды 'sbs status' добавлена информация об открытых скриптом портах из WAN, если порты настроены в меню 'sbs server' и скрипт запущен.
2. Теперь, при одновременном использовании обычной маршрутизации sing-box для одних ip адресов/подсетей и маршрутизации через fakeip для других, не нужно вручную добавлять в исключения обычной маршрутизации ip адреса/подсети, настроенные для работы через fakeip. В связи с этим внесены изменения в Readme (раздел IV пункты 3 и 4).
3. Исправление порядка сортировки подсетей для формирования правильного порядка правил маршрутизации.

Версия 2.0 от 03.05.25
1. При старте скрипта добавлена проверка на дубликаты добавленных ip адресов и подсетей. Если обнаруживаются, то старт скрипта отменяется с уведомлением о дубликатах. Это необходимо для корректной работы скрипта.
2. Добавлена поддержка fakeip для ядер sing-box версий 1.12.*
3. Добавлена поддержка tproxy интерфейса.
4. В меню 'sbs setup' добавлено подменю продвинутых настроек.
5. В подменю продвинутых настроек меню 'sbs setup' перенесена смена номера таблицы маршрутизации. Так же в это подменю добавлена возможность смены метки tproxy-mark, которая появляется, если в конфигурационном файле sing-box прописан tproxy интерфейс.
6. Оптимизация некоторых участков старого кода.

Версия 2.1 от 21.06.25
1. При парсинге скриптом конфигурационного файла config.json теперь игнорируются закомментированные строки.
2. Добавлена возможность выбора репозитория для установки ядра sing-box. На выбор официальный и 2 кастомных. Для этого в меню sbs update добавлен 3-й пункт для смены репозитория ядра sing-box и настройки кастомных репозиториев.
3. Несколько оптимизаций и улучшений кода основного скрипта и скрипта-монитора.
